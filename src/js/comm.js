gm.comm=function(){function e(e,t,n,o,i){function r(){d||e(d=!0)}function c(){d!==!1&&e(d=!1)}function u(){gm.comm.webServiceRequest(r,c,{url:t,method:i.method||"POST",timeout:o}),g=setTimeout(u,n)}var a=5e3,s=3e4,m=3e3,l=2e3,d=null;return"function"!=typeof e?void gm.util.log("watchInternetConnectivity callback should be a function"):"string"!=typeof t?void gm.util.log("watchInternetConnectivity url should be a string"):("object"==typeof n?i=n:"object"==typeof o&&(i=o),i=i||{},isNaN(n)||n<a?n=a:n>s&&(n=s),isNaN(o)||o<m?o=m:o>n-l&&(o=n-l),clearTimeout(g),void(g=setTimeout(u,0)))}function t(){clearTimeout(g)}function n(e){var t=gm.hmi.getNetworkConnectivity();return"function"!=typeof e?t:void e(t)}function o(e,t){return gm.hmi.watchNetworkConnectivity(function(t){e(!!t)},t)}function i(e){gm.hmi.clearNetworkConnectivity(e)}function r(e,t,n,o){return gm.communication.sendToApp(e,t,n,o)}function c(e,t){return t=t||gm.util.optionalMethod,h.push(t),f.add(e,t)}function u(e,t){function n(t){return gm._dataIsValid(t.data)||h.forEach(function(e){e()}),e(t)}return gm.communication.watchForData(n,t)}function a(e){return gm.communication.clearWatchForData(e)}function s(e){return f.clear(e)}function m(e,t,n,o){return gm.communication.sendToPhone(e,t,n,o)}function l(e,t,n){var o,i,r,c;return"function"!=typeof t&&(n=t,t=gm.system._optionalMethod),"string"!=typeof n.url?(gm.util.log("webServiceRequest options.url should be a string"),t()):"function"!=typeof e?(gm.util.log("webServiceRequest success should be a function"),t()):(n.method=(n.method||"GET").toUpperCase(),o=Object.keys(n.parameters||{}).map(function(e){var t=n.parameters[e];return[e,t].map(encodeURIComponent).join("=")}).join("&"),"POST"!==n.method&&o&&(n.url+="?"+o,o=c),n.cache||(i=n.url.indexOf("?")>-1,n.url+=(i?"&":"?")+"rand="+Date.now()),r=new XMLHttpRequest,r.timeout=n.timeout||0,r.open(n.method,n.url,!0),r.onabort=r.ontimeout=r.onerror=t,r.onload=function(){var n=!gm._dataIsValid(r.responseText),o=!r.status&&!r.responseText;return o?(gm.util.log("webServiceRequest has no response"),t()):n?(gm.util.log("webServiceRequest response invalid data"),t()):(r.responseHeaders=r.getAllResponseHeaders(),void e(r))},Object.keys(n.headers||{}).forEach(function(e){r.setRequestHeader(e,n.headers[e])}),void r.send(o))}function d(e,t,n){return gm.communication.sendFile(e,t,n)}var f=new gm.util.WatchManager({watchMethod:u,clearMethod:a}),h=[],g=0;return{watchInternetConnectivity:e,clearInternetConnectivity:t,getNetworkConnectivity:n,watchNetworkConnectivity:o,clearNetworkConnectivity:i,sendToApp:r,watchForData:c,clearWatchForData:s,sendToPhone:m,webServiceRequest:l,sendFile:d}}();