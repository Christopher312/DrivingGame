gm.monitor=function(){"use strict";function n(n){return function(r){return typeof r===n}}function r(n){return n.replace(/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,"")}function t(n){var t=/^function\s*[^(]*\(([^)]+)\)/,o=t.exec(r(n));if(!o)throw new TypeError("No dependencies found");return o[1].split(",").map(function(n){return n.trim()})}function o(n,r,t){function o(o){var e;if(3===o.senderID){try{e=JSON.parse(o.data)}catch(n){return}if(e.command===t.command){if(gm.communication.clearWatchForData(a),e.error)return r(e.error);e=e.command===d.LIST&&e.data&&e.data.monitors,n(e||null)}}}var e,i,a,f=c(n)&&c(r)&&m(t),s=t.command===d.LIST;if(!f)throw new TypeError("Mismatched arguments");if(!s&&!u(t.data.name))throw new TypeError("Monitor Name not provided");return e=JSON.stringify(t),i=gm.communication.sendToApp(3,e.length,e),0!==i?r(i):void(a=gm.communication.watchForData(o,r))}function e(n,r,e){if(e=e||{},!c(e.callback))throw new TypeError("Callback Function not provided");e.callback=e.callback.toString(),e.inject=e.inject||t(e.callback),o(n,r,{command:d.REGISTER,data:e})}function i(n,r){o(n,r,{command:d.LIST})}function a(n,r,t){o(n,r,{command:d.UNREGISTER,data:t||{}})}var c=(Array.prototype.slice,n("function")),m=n("object"),u=n("string"),d={REGISTER:"monitor.register",LIST:"monitor.list",UNREGISTER:"monitor.unregister"};return{register:e,list:i,unregister:a}}();