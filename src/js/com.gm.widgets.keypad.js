function isDefined(e){var t=null===e,n="undefined"==typeof e;return!(t||n)}function isNewKeyboardMarket(e){var t=["china"];return t.indexOf(e)>=0}function doesSupportNewKeyboard(){return isDefined(gm.hmi.showKeypad)&&isDefined(gm.hmi.showKeypad)}function boschKeyboard(){function e(e,t){return{type:a(e),placeholderText:i(e),initialValue:s(e),maxLength:isDefined(t)?t:2048}}function t(e){var t=e.getAttribute("type"),n=e.getAttribute("data-gm_kp_type");isDefined(n)||(n=isDefined(t)?t:"text",e.setAttribute("data-gm_kp_type",n)),e.setAttribute("type","disabled")}function n(e){try{var t="",n=typeof e.value;if("object"===n){var a=Array.prototype.slice.call(e.value);t=String.fromCharCode.apply(String,a)}"string"===n&&(t=e.value)}catch(e){console.log("e",e)}return t}function a(e){var t=e.getAttribute("data-gm_kp_type");return t=isDefined(t)?t:e.getAttribute("type"),t=isDefined(t)?t:"text",t=o[t]}function i(e){var t=e.getAttribute("data-placeholder");return t=isDefined(t)?t:e.getAttribute("placeholder"),t=isDefined(t)?t:""}function s(e){var t=e.getAttribute("data-inputvalue");return t=isDefined(t)?t:e.getAttribute("value"),t=isDefined(t)?t:""}var l=0,r=1,d=2,o={text:0,email:0,disabled:0,number:1,tel:2,password:3};return{hideKeypad:function(){gm.hmi.hideKeypad()},initKeypad:function(a){function i(e,t){switch(console.log("Failure in showKeypad",t),t){case 10:console.log("Keyboard is already displayed on the screen");break;case 11:console.log("Requesting application is in the background")}p()}function s(e,t){p();var i=n(t),s={value:i,element:e};if(isDefined(t)&&isDefined(t.status))switch(t.status){case l:e.setAttribute("data-inputvalue",i),a.onSubmit(s);break;case r:c||a.onCancel(s);break;case d:m=c?i:void 0}}function o(e,t,n){var a=n===gm.constants.appState.AS_FOREGROUND||n===gm.constants.appState.AS_FOREGROUND_LOCKED,l=n===gm.constants.appState.AS_BACKGROUND||n===gm.constants.appState.AS_BACKGROUND_LOCKED;l&&!c&&(c=!0),c&&a&&(isDefined(m)&&(t.initialValue=m),c=!1,m=void 0,gm.hmi.showKeypad(s.bind(null,e),i.bind(null,e),t))}function p(){h=!1,m=void 0,isDefined(u)&&(gm.appmanager.clearFocus(u),u=void 0)}var u,c,m,h=!1,g={},y=a.mainContent,f=isDefined(y)?document.getElementById(y):document.body;a&&a.autoHideOnDrive&&keyboardAutoHideOnDrive.startKeyboardDriverGuard();for(var b=["[data-gm_kp_type]","input[type=text]","input[type=email]","input[type=number]","input[type=password]","input[type=disabled]"].toString(),w=f.querySelectorAll(b),v=0,k=w.length;v<k;v++){var _=w[v];t(_),_.onmousedown=function(){h||(h=!0,g=e(_,a.maxLength),u=gm.appmanager.watchFocus(o.bind(null,_,g)),gm.hmi.showKeypad(s.bind(null,_),i.bind(null,_),g))}}}}}function app0Keyboard(){function e(){var s,l=document,r=(new Date).getTime(),d=null,o="output-wrapper",p="output-subwrapper",u="placeholder-element",c="clear-output",m="",h="common-keys",g="the-cursor",y=null,f=0,b="kb-output-preview",w="kb-backspace",v=null,k=null,_={},E={},B="",N="",C=!1,D=!1,I="",K="•",S=null,T="generic-keyboard",A="main-wrapper"+r,R=null,x=null,P=null,L=null,O=null,H="mousedown",M="remove-me",U=!1,G=null,F=!1,W=null,j=null,V=null,z=null,q=2,X=!1,Y=[],$=-1;return{HBConstants:{all:2,bosch:1,none:0},KPTypes:{kp_number:"number",kp_text:"text",kp_password:"password",kp_email:"email"},KPState:{kp_upper_enabled:"upper",kp_lower_enabled:"lower",kp_symbol_enabled:"symbol"},initKeypad:function($){function J(){if(X&&2===gm.vehicle.getSpeed()){var e=[{label:i,callBack:function(){t.popup=null}}];return t.popup=new gm.widgets.PopUp({title:n,description:a,buttonsArray:e,closeBtnCallback:function(){t.popup=null}}),void(t.popup&&t.popup.render&&t.popup.show&&(t.popup.render(),t.popup.show()))}Q(this)}function Q(e){return W=e,ee(),Z(A,"none"),F&&(t.watchRotaryHandle=gm.info.watchRotaryControl(t.processSuccessfulRotaryEvent,function(){console.log("Keypad: Watch Rotary Failed")})),!1}function Z(e,t){var n;if(q===gm.widgets.keypad.HBConstants.all||q===gm.widgets.keypad.HBConstants.bosch&&U)if(t){for(n=l.createElement("div"),n.id=A;O.firstChild;){var a=O.firstChild;if(a.id===T)break;n.appendChild(a)}O.appendChild(n),n.style.display=t}else{var i=l.getElementById(T);for(n=l.getElementById(e);n.firstChild;){var s=n.firstChild;O.insertBefore(s,i)}O.removeChild(n)}}function ee(){var e="",t=[],n=function(){_.number||S!==gm.widgets.keypad.KPTypes.kp_number?_.keypad||S!==gm.widgets.keypad.KPTypes.kp_password&&S!==gm.widgets.keypad.KPTypes.kp_text&&S!==gm.widgets.keypad.KPTypes.kp_email||(e="keypad",t=keysets,_[e]=[]):(e="number",t=numpadKeysets,_[e]=[]);for(var n=0;n<t.length;n++){var a={};if(a.upper=null,t[n].keysetLower&&(a.lower=le(t[n].keysetLower),d.insertBefore(a.lower,k)),t[n].keysetUpper&&(a.upper=le(t[n].keysetUpper),d.insertBefore(a.upper,k)),a.toggleKey=t[n].toggleKey,a.reverseKey=t[n].reverseKey,_[e].push(a),null!=t[n].symbolSet){E[t[n].reverseKey]=[];for(var i=t[n].symbolSet,s=0;s<i.length;s++){var l={};l.symbolSet=le(i[s].symbolSet),d.insertBefore(l.symbolSet,k),l.symbolKey=null!=i[s].symbolKey?i[s].symbolKey:null,E[t[n].reverseKey].push(l)}}}_.number&&(_.number[0].lower.id="kb-numpad-number-keys"),ie(S)};S=W.getAttribute("data-gm_kp_type")?W.getAttribute("data-gm_kp_type"):W.getAttribute("type"),N=W.getAttribute("data-inputvalue"),""===m?(d=l.createElement("div"),m=l.createDocumentFragment(),d.addEventListener(H,se),d.id=T,v=le(keyboardTopRow),d.appendChild(v),k=le(keyboardBottomRow),d.appendChild(k),d.setAttribute("data-idRandomizer",r),U||(d.className="panasonic"),m.appendChild(d),O.appendChild(m),n(),ue(d)):(O.removeChild(d),U?d.className="":d.className="panasonic",j.innerHTML="",n(),te(d)),ne(gm.widgets.keypad.KPState.kp_lower_enabled)}function te(e){var t=l.createDocumentFragment(),n=z.style.display;if(z.textContent="INPUT"===W.tagName?W.getAttribute("placeholder"):W.getAttribute("data-placeholder"),N)for(B=N,we=0,ve=N.length;we<ve;we++){var a,i=l.createElement("span");if(S===gm.widgets.keypad.KPTypes.kp_password)a=l.createTextNode(K);else if(" "===N[we]){var s=" ";a=l.createTextNode(s)}else a=l.createTextNode(N[we]);i.setAttribute("data-method","p-char"),i.appendChild(a),t.appendChild(i)}else B="";t.appendChild(V),j.appendChild(t),n=N?"none":"block",z.style.display=n,ie(S),O.appendChild(e),N?me(!1,!1,!0):me()}function ne(e){if(F){for(var t,n=l.getElementById(T).getElementsByTagName("li"),a=null,i=null,r=0,d=n.length;r<d;r++){var o=n[r];0!==o.offsetHeight&&0!==o.offsetWidth&&(a?o.id===b?(t=o.querySelector("#"+c)||o,i.nextElement=t,t.previousElement=i,i=t):(i.nextElement=o,o.previousElement=i,i=o):o.id===b?(t=o.querySelector("#"+c)||o,a=t,i=t):(a=o,i=o))}var p;switch(e){case gm.widgets.keypad.KPState.kp_lower_enabled:p=y.lower.children[0];break;case gm.widgets.keypad.KPState.kp_upper_enabled:p=y.upper.children[0];break;case gm.widgets.keypad.KPState.kp_symbol_enabled:p=y.symbolSet.children[0];break;default:p=y.lower.children[0]}G&&G.classList.remove(s),G=p,G.classList.contains(s)||G.classList.add(s),i.nextElement=a,a.previousElement=i}}function ae(e,t){y=e,f=t,null!==e&&(y.className=h)}function ie(e){switch(null!==y&&(y.lower.className=M,y.upper&&(y.upper.className=M)),C=!1,e){case gm.widgets.keypad.KPTypes.kp_number:ae(_.number[0],0),v.className="numpad",_.number[0].lower.className=h,k.className=M;break;default:ae(_.keypad[0],0),v.className="",_.keypad[0].lower.className="",k.className="",fe(1)}}function se(e){var t,n,a=e.target,i=a.getAttribute("data-method"),s=a.getAttribute("data-option");switch(i){case"char":pe(s?s:a.firstChild.nodeValue);break;case"p-char":t=l.getElementById(g),n=l.getElementById(p),e.offsetX>a.offsetWidth/2?n.insertBefore(t,a.nextSibling):n.insertBefore(t,a),me(),e.stopPropagation();break;case"clear":ce();break;case"enable-preview":t=l.getElementById(g),n=l.getElementById(p),e.pageX>n.lastChild.getBoundingClientRect().right&&n.appendChild(t),ue();break;case"backspace":de();break;case"close":re(),P&&"function"==typeof P&&(W.setAttribute("data-inputvalue",B),P({value:B,element:W}));break;case"cancel":re(),L&&"function"==typeof L&&L({value:B,element:W});break;case"shift":ge();break;case"key-type":ye()}}function le(e){var t,n,a,i,s=l.createElement("ul");if(s.className=M,"string"==typeof e[1]){for(t=0,n=e.length;t<n;t++)if(a=l.createElement("li"),i=l.createTextNode(e[t]),a.appendChild(i),a.setAttribute("data-method","char"),e[t].match(/^\.\w{2,}/)&&(a.className+="keysize2"),s.appendChild(a),t===n-1)return s}else for(t=0,n=e.length;t<n;t++)if(a=l.createElement("li"),e[t].content&&(i=l.createTextNode(e[t].content),a.appendChild(i)),e[t].id&&(a.id=e[t].id),e[t].classes&&(a.className=e[t].classes),e[t].aMethod&&a.setAttribute("data-method",e[t].aMethod),e[t].anOpt&&a.setAttribute("data-option",e[t].anOpt),s.appendChild(a),t===n-1)return s}function re(){var e=l.getElementById(T);e&&e.className.indexOf(M)===-1&&(Z(A),e.className+=" "+M,F&&(G.classList.remove(s),gm.info.clearRotaryControl(t.watchRotaryHandle))),e&&(D===!1?C?(C=!1,_.keypad[f].upper.className=M):S!==gm.widgets.keypad.KPTypes.kp_number?_.keypad[f].lower.className=M:(_.number[0].lower.className=M,k.className=""):(E[I][f].symbolSet.className=M,k.children[2].innerText=_.keypad[0].toggleKey,D=!1),fe(1),ae(null,0))}function de(){var e=l.getElementById(p),t=l.getElementById(g),n=t.previousSibling,a=l.getElementById(u);if(oe(S,Y),n){var i=Array.prototype.indexOf.call(e.children,t);B=B.slice(0,i-1)+B.slice(i),e.removeChild(n)}me(),e.childNodes.length<=1&&"none"===a.style.display&&(a.style.display="block")}function oe(e,t){if(e===gm.widgets.keypad.KPTypes.kp_password)for(var n=0;n<t.length;n++)t[n].innerText=K;t.length=0}function pe(e){var t=null,n=l.getElementById(u),a=l.getElementById(g),i=l.getElementById(p),s=l.getElementById(b),r=l.getElementById(w),d=null,o=i.offsetWidth,c=Array.prototype.indexOf.call(i.childNodes,a);v.removeChild(s),"none"!==n.style.display&&(n.style.display="none"),oe(S,Y);for(var m=0;m<e.length;m++)t=l.createTextNode(e[m]),d=l.createElement("span"),d.appendChild(t),d.setAttribute("data-method","p-char"),Y.push(d),B=B.substr(0,c)+e[m].replace(" "," ")+B.substr(c),c++,i.insertBefore(d,a);v.insertBefore(s,r),me(null,i.offsetWidth-o)}function ue(e){var t=l.getElementById(b);if(""===t.innerHTML){j=l.createElement("span"),z=l.createElement("span");var n=l.createElement("span"),a=W.getAttribute("placeholder")||"",i=l.createTextNode(a),s=l.createElement("span"),r=l.createTextNode("×");n.id=o,j.id=p,j.setAttribute("data-method","enable-preview"),z.id=u,z.appendChild(i),s.id=c,s.setAttribute("data-method","clear"),s.appendChild(r),n.appendChild(j),t.appendChild(z),t.appendChild(s),t.appendChild(n)}if(!l.getElementById(g)){V=l.createElement("span");var d=l.getElementById(p);V.id=g,d.appendChild(V)}e&&N&&te(e)}function ce(){var e=l.getElementById(u);l.getElementById(p).innerHTML="",B="","none"===e.style.display&&(e.style.display="block"),he(),ue(),event.stopPropagation()}function me(e,t,n){var a,i=e?e:l.getElementById(g),s=t?t:30,r=l.getElementById(p),d=r.offsetLeft,o=i.offsetLeft+d,u=r.getElementsByTagName("span"),c=u.length,m=u[c-1].offsetLeft;m<357?he(r):o<30&&d<0?(a=d+30,a>0?he(r):r.style.left=a+"px"):n&&m>357?(m+=s,m-=329,r.style.left="-"+m+"px"):o>327&&(a=d-s,r.style.left=a+"px")}function he(e){var t=e?e:l.getElementById(p);t.style.left=0}function ge(){C?(y.lower.className="",y.upper.className=M,C=!1,fe(1),k.children[1].className=k.children[1].className.replace(/\sshiftLower/g,""),ne(gm.widgets.keypad.KPState.kp_lower_enabled)):D?1!==E[I].length&&(E[I][++f]?(E[I][f-1].symbolSet.className=M,E[I][f].symbolSet.className="",ae(E[I][f],f),k.children[1].innerText=null!=E[I][f].symbolKey?E[I][f].symbolKey:""):(E[I][f-1].symbolSet.className=M,E[I][0].symbolSet.className="",ae(E[I][0],0),k.children[1].innerText=null!=E[I][0].symbolKey?E[I][0].symbolKey:""),ne(gm.widgets.keypad.KPState.kp_symbol_enabled)):y.upper&&(fe(0),k.children[1].className+=" shiftLower",y.lower.className=M,y.upper.className="",C=!0,ne(gm.widgets.keypad.KPState.kp_upper_enabled))}function ye(){D===!1?(C?(C=!1,_.keypad[f].upper.className=M):_.keypad[f].lower.className=M,_.keypad[++f]?null!==_.keypad[f].lower&&(ae(_.keypad[f],f),_.keypad[f].lower.className="",k.children[2].innerText=keysets[f].toggleKey,ne(gm.widgets.keypad.KPState.kp_lower_enabled)):f=0,0===f&&null!==_.keypad[_.keypad.length-1].reverseKey&&(I=_.keypad[_.keypad.length-1].reverseKey,E[I][0].symbolSet.className="",k.children[2].innerText=I,k.children[1].className="keysize2 grey",k.children[1].innerText=null!==E[I][0].symbolKey?E[I][0].symbolKey:"",ae(E[I][0],0),D=!0,ne(gm.widgets.keypad.KPState.kp_symbol_enabled))):(E[I][f].symbolSet.className=M,ae(_.keypad[0],0),_.keypad[0].lower.className="",k.children[2].innerText=_.keypad[0].toggleKey,fe(1),D=!1,ne(gm.widgets.keypad.KPState.kp_lower_enabled))}function fe(e){"undefined"!=typeof keyboardBottomRow[1].content&&null!==keyboardBottomRow[1].content?(k.children[1].className="keysize2 grey sprite ",k.children[1].innerHTML=shiftkeyCharacters[e]):(k.children[1].className="keysize2 grey sprite centeredArrow",k.children[1].innerHTML="")}s=GMLIB_ROTARY_CLASS,n=keyboardCopy.title,a=keyboardCopy.description,i=keyboardCopy.button,t||(t=e()),"object"==typeof $&&(R=l.getElementById($.mainContent),q="number"==typeof $.hideBody?$.hideBody:2,P=$.onSubmit,L=$.onCancel,$.driverDistractionPopupText&&(a=$.driverDistractionPodriverDistractionPopupTitle)),$&&$.autoHideOnDrive&&keyboardAutoHideOnDrive.startKeyboardDriverGuard(),O=l.body,x=R.querySelectorAll("[data-gm_kp_type],input[type=text],input[type=email],input[type=number],input[type=password],input[type=disabled]");for(var be,we=0,ve=x.length;we<ve;we++){var ke=x[we];ke.id||(ke.id="_gen-kb-id-"+we),be=ke.getAttribute("type"),be&&(ke.dataset.gm_kp_type=be,ke.setAttribute("type","disabled")),ke.onmousedown=J}t.hideKeypad=re},destroy:function(){if(null!=t){if(!x)return;for(var e=0,n=x.length;e<n;e++){var a=x[e];a.onmousedown=null}null==t.popup&&t.hideKeypad?t.hideKeypad():(t.popup.destroy&&t.popup.destroy(),t.popup=null);var i=l.getElementById(T);i&&(i.className=" "),d&&O.removeChild(d),m="",d=null,v=null,k=null,_={},E={},B="",N="",C=!1,D=!1,y=null,G=null,W=null,j=null,V=null,z=null,q=2,Y=[],$=-1,t=null}},instanceExists:function(){return null!=t&&null!=x},keyboardContainerExists:function(){return null!=d},watchRotaryPopupExist:function(){return!!t.popup},processSuccessfulRotaryEvent:function(e){switch(e[0]){case"RC_CW":G.classList.remove(s),G=G.nextElement,G.classList.add(s);break;case"RC_CCW":G.classList.remove(s),G=G.previousElement,G.classList.add(s);break;case"RC_SELECT":var t=function(){n=l.createEvent("MouseEvent"),n.initEvent("mouseup",!0,!1),G.dispatchEvent(n),n=l.createEvent("MouseEvent"),n.initEvent("click",!0,!1),G.dispatchEvent(n)},n=l.createEvent("MouseEvent");n.initEvent("mousedown",!0,!1),G.dispatchEvent(n),setTimeout(t,100)}},setBosch:function(){U=!0},setSpeedLockout:function(){X=!0},setRotary:function(){F=!0}}}var t,n,a,i;return function(){function s(e){m.indexOf(e)===-1&&(e=c);for(var t,n=["GMLIB/keypad/keyset."+e.substr(0,2)+"."+e.substr(-2,2)+".js"],a=0,i=n.length;a<i;a++)t=o.createElement("script"),t.setAttribute("src",n[a]),u.appendChild(t);p.appendChild(u)}function l(e){r=o.createElement("link"),r.setAttribute("href","GMLIB/keypad/themes/baseKeypad.css"),r.setAttribute("rel","stylesheet"),p.appendChild(r)}var r,d,o=document,p=o.head,u=o.createDocumentFragment(),c="en-US",m=["en-US","es-US","es-ES","fr-CA","fr-FR","ar-SA","zh-CN","de-DE","it-IT","en-GB","es-MX","nl-NL","pl-PL","pt-BR","pt-PT"],h=window,g=function(){var e=[{label:i,callBack:function(){t.hideKeypad(),t.popup=null}}];t.popup=new gm.widgets.PopUp({title:n,description:a,buttonsArray:e,closeBtnCallback:function(){t.hideKeypad(),t.popup=null}}),t.popup&&t.popup.render&&t.popup.show&&(t.popup.render(),t.popup.show())};try{gm.vehicle.getVehicleConfiguration(function(e){s(gm.constants.language[e.language]),l(e.theme),(e.DUN||e.PAN)&&h.setTimeout(function(){t.setBosch()},0),e.buttonsAvailable.RC_SELECT&&h.setTimeout(function(){t.setRotary()},0),"USA"!==e.region&&"Canada"!==e.region&&"Europe"!==e.region&&"North America"!==e.region||(h.setTimeout(function(){t.setSpeedLockout()},0),gm.vehicle.watchSpeed(function(e){if(e!==d)if(d=e,e>=2){var n=o.getElementById("generic-keyboard");n&&n.className.indexOf("remove-me")===-1&&g()}else t.popup&&(t.popup.destroy(),t.popup=null)},function(){console.log("WatchSpeed error")}))},function(){s(c),l(defaultTheme)})}catch(e){console.log("Error:"+e)}return t||(t=e()),t}()}!function(){var e={};this.tmpl=function t(n,a){var i=/\W/.test(n)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+n.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):e[n]=e[n]||t(document.getElementById(n).innerHTML);return a?i(a):i}}(),window.gm=window.gm||{},gm.widgets=gm.widgets||{},gm.widgets.templates=[],gm.widgets.templates[0]='<script type="text/html" id="gm_widget_base_template" style="display:none;"><div id="<%=id%>"><p><%=label%></p></div></script>',gm.widgets.templates[1]='<script type="text/html" id="gm_widget_button_template" style="display:none;"><button class="gm_widget_button" id="<%=id%>" tabindex="0" <%= ( disabled ? "disabled = \'disabled\'" : "" ) %>><%=label%></button></script>',gm.widgets.templates[2]='<script type="text/html" id="gm_widget_popup_template" style="display:none;"><div id="<%=id%>" class="gm_widget_popup hidden" ><div class="gm_widget_popup_header"><div class="gm_widget_popup_title"></div><div class="gm_widget_popup_close_container"></div></div><div class="gm_widget_popup_description"></div><div class="gm_widget_popup_buttons"></div></div></script>',gm.widgets.templateOptionsHash={gm_widget_base_template:["id","label"],gm_widget_button_template:["id","label","disabled"],gm_widget_popup_template:["id"]},gm.widgets.TemplateParams=function(){var e=function(e,t){for(var n=gm.widgets.templateOptionsHash[e]||[],a=0,i=n.length,s={};a<i;a++)s[n[a]]=t[n[a]]||"";return s};return{getTemplateData:e}}(),function(){for(var e=0,t=gm.widgets.templates,n=t.length;e<n;e++)document.head.innerHTML+=gm.widgets.templates[e]}(),gm.widgets.IDGenerator=function(){var e=0,t=function(){e++},n=function(){return"gm_widget_autogen_"+e},a=function(){return t(),n()};return{getId:a}}(),gm.widgets.util={trimString:function(e){var t=e.replace(/^\s+|\s+$/g,"");return t},isInList:function(e,t){for(var n=0,a=e.length;n<a;n++)if(String(e[n])===String(t))return!0;return!1},isInName:function(e,t){var n=gm.widgets.util.trimString(e),a=n.split(" "),i=gm.widgets.util.isInList(a,t);return i},modClassName:function(e,t,n){var a=gm.widgets.util.trimString(e),i=(a.split(" "),""===a),s=gm.widgets.util.isInName(a,t);switch(n){case"add":s||(i?a=t:a+=" "+t);break;case"remove":s&&(a=a.replace(t,""))}return gm.widgets.util.trimString(a)}},gm.widgets.ElTapHandler=gm.widgets.ElTapHandler||function(e){var t,n,a=this,i=30;this.el=e.el,this.elementId=e.elementId,this.callBack=e.callBack,this.disabled=e.disabled,this.events={};var s=function(){t=null,n=null},l=function(){a.events={}},r=function(){a.events.click||a.events.touchstart&&a.events.touchend?(l(),s(),"function"==typeof a.callBack&&a.callBack.apply(null)):(l(),s())},d=function(e){e.preventDefault(),e.stopPropagation(),a.events.click="click",r()},o=function(e){t=e.touches[0].clientX,n=e.touches[0].clientY,l(),a.events.touchstart="touchstart",e.preventDefault(),e.stopPropagation()},p=function(e){var d,o,p=!1;d=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,p=Math.abs(d-t)<=i&&Math.abs(o-n)<=i,a.events.touchstart&&p?(a.events.touchend="touchend",r()):(l(),s()),e.preventDefault(),e.stopPropagation()},u=function(){a.el.removeEventListener("touchstart",o,!1),a.el.removeEventListener("touchend",p,!1),a.el.removeEventListener("click",d,!1)},c=function(){a.el.addEventListener("touchstart",o,!1),a.el.addEventListener("touchend",p,!1),a.el.addEventListener("click",d,!1)};this.start=function(){this.disabled=!1,l(),s(),u(),c()},this.stop=function(){l(),s(),this.disabled=!0,u()},this.disabled||this.start()},gm.widgets.Base=gm.widgets.Base||function(e){this.id=gm.widgets.IDGenerator.getId(),this.parentElement=e&&e.parentElement?e.parentElement:document.getElementsByTagName("body")[0],this.templateId="gm_widget_base_template",this.defaultLabel="",this.value=e&&e.hasOwnProperty("value")&&"function"!=typeof e.value?e.value:null,this.disabled=!(!e||!e.hasOwnProperty("disabled")||e.disabled!==!0&&"true"!==e.disabled),this.label=e&&e.label?e.label:this.defaultLabel,this.element=null,this.callBack=e&&e.callBack&&"function"==typeof e.callBack?e.callBack:null,this.templateOptions=gm.widgets.TemplateParams.getTemplateData(this.templateId,this)},gm.widgets.Base.prototype.render=function(e){if(this.hasRendered())console.log("The item "+this.id+" has already been rendered");else{var t,n=this.templateOptions,a=document.createElement("div");a.innerHTML=tmpl(this.templateId,n),t=a.firstChild.cloneNode(!0),this.disabled&&t.className.indexOf("disabled")<0&&(""===t.className?t.className="disabled":t.className+=" disabled"),this.parentElement.appendChild(t),this.element=document.getElementById(this.id)}"function"==typeof e&&e.apply(null)},gm.widgets.Base.prototype.hasRendered=function(){return Boolean(document.getElementById(this.id))},gm.widgets.Base.prototype.attachEventHandles=function(){},gm.widgets.Base.prototype.detachEventHandles=function(){},gm.widgets.Base.prototype.setValue=function(e){var t="function"!=typeof e;t&&(this.value=e)},gm.widgets.Base.prototype.getValue=function(){return this.value},gm.widgets.Base.prototype.disable=function(){this.disabled=!0,this.hasRendered()&&(""===this.element.className?this.element.className="disabled":this.element.className.indexOf("disabled")===-1&&(this.element.className+=" disabled"),this.detachEventHandles())},gm.widgets.Base.prototype.enable=function(){if(this.disabled=!1,this.hasRendered()){var e=this.element.className,t="";t=e.replace("disabled",""),t=gm.widgets.util.trimString(t),this.element.className=t,this.attachEventHandles()}},gm.widgets.Base.prototype.destroy=function(){this.hasRendered()&&this.parentElement.removeChild(this.element),this.detachEventHandles()},gm.widgets.Button=gm.widgets.Button||function(e){var t=this;this.id=gm.widgets.IDGenerator.getId(),this.parentElement=e&&e.parentElement?e.parentElement:document.getElementsByTagName("body")[0],this.templateId="gm_widget_button_template",this.defaultLabel="",this.value=e&&e.hasOwnProperty("value")&&"function"!=typeof e.value?e.value:null,this.disabled=!(!e||!e.hasOwnProperty("disabled")||e.disabled!==!0&&"true"!==e.disabled),this.label=e&&e.hasOwnProperty("label")?e.label:" ",this.element=null,this.callBack=e&&e.callBack&&"function"==typeof e.callBack?e.callBack:null,this.templateOptions=gm.widgets.TemplateParams.getTemplateData(this.templateId,this),this.width=e&&e.width&&e.width>0?Number(e.width):"",this.height=e&&e.height&&e.height>0?Number(e.height):"",this.uiEventManager={};var n=function(){"function"==typeof t.callBack&&t.callBack.apply(null)};this.render=function(e){gm.widgets.Button.prototype.render.apply(t),this.uiEventManager=new gm.widgets.ElTapHandler({el:this.element,elementId:this.id,callBack:n,disabled:this.disabled}),""!==t.width&&(t.element.style.width=t.width+"px"),""!==t.height&&(t.element.style.height=t.height+"px"),"function"==typeof e&&e.apply(null)},this.disable=function(){gm.widgets.Button.prototype.disable.apply(t),this.hasRendered()&&this.element.setAttribute("disabled","disabled")},this.enable=function(){gm.widgets.Button.prototype.enable.apply(t),this.hasRendered()&&this.element.getAttribute("disabled")&&this.element.removeAttribute("disabled")}},gm.widgets.Button.prototype=Object.create(gm.widgets.Base.prototype),gm.widgets.Button.prototype.constructor=gm.widgets.Button,gm.widgets.Button.prototype.attachEventHandles=function(){this.hasRendered()&&this.uiEventManager.start()},gm.widgets.Button.prototype.detachEventHandles=function(){this.hasRendered()&&this.uiEventManager.stop()},gm.widgets.PopUp=gm.widgets.PopUp||function(e){var t=this;this.watchRotaryHandle=-1,this.styleNodeId="style_Popup",this.id=gm.widgets.IDGenerator.getId(),this.parentElement=document.getElementsByTagName("body")[0],this.templateId="gm_widget_popup_template",this.element=null,this.width=e&&e.hasOwnProperty("width")?e.width:null,this.height=e&&e.hasOwnProperty("height")?e.height:null,this.left=e&&e.hasOwnProperty("left")?e.left:null,this.top=e&&e.hasOwnProperty("top")?e.top:null,this.origTopNum=parseInt(this.top),this.bgTopDif=0+parseInt(this.top),this.title=e&&e.hasOwnProperty("title")?e.title:"",this.description=e&&e.hasOwnProperty("description")?e.description:"",this.buttonsArray=e&&e.hasOwnProperty("buttonsArray")?e.buttonsArray:[],this.titleDiv=null,this.descriptionDiv=null,this.buttonsDiv=null,this.headerDiv=null,this.wrapperDivId="gm_wrapper_"+this.id,this.templateOptions=gm.widgets.TemplateParams.getTemplateData(this.templateId,this);var n=document.createElement("link");return n.id=this.styleNodeId,n.setAttribute("href","GMLIB/com.gm.widgets.popup.css"),n.setAttribute("rel","stylesheet"),document.head.appendChild(n),this.render=function(n){function a(e,t){var n={width:1,height:1};switch(i||(i=window.innerWidth),i>800&&(n.width=1.6,n.height=1.5),e){case"width":var a=t?parseInt(t,10):600;return n.width*a+"px";case"height":var s=t?parseInt(t,10):160;return n.height*s+"px";case"left":var l=t?parseInt(t,10):100;return n.width*l+"px";case"top":var r=t?parseInt(t,10):120;return n.height*r+"px"}}if(!this.hasRendered()){var i,s=document.createElement("div");s.id=this.wrapperDivId,s.classList.add("gm_widget_popup_wrapper"),s.classList.add("hidden"),this.parentElement.appendChild(s),gm.widgets.PopUp.prototype.render.apply(t),this.headerDiv=this.element.getElementsByClassName("gm_widget_popup_header")[0],this.titleDiv=this.element.getElementsByClassName("gm_widget_popup_title")[0],this.descriptionDiv=this.element.getElementsByClassName("gm_widget_popup_description")[0],this.buttonsDiv=this.element.getElementsByClassName("gm_widget_popup_buttons")[0];var l=this.element.getElementsByClassName("gm_widget_popup_close_container")[0],r=new gm.widgets.Button({callBack:function(){t.destroy(),"function"==typeof e.closeBtnCallback&&e.closeBtnCallback()},parentElement:l});r.render(),this.element.style.width=a("width",this.width),this.element.style.height=a("height",this.height),this.element.style.left=a("left",this.left),this.element.style.top=a("top",this.top),this.titleDiv.innerHTML=this.title,this.descriptionDiv.innerHTML=this.description,this.thatcallBack=[];var d=function(e){return function(){t.destroy(),"function"==typeof t.thatcallBack[e]&&t.thatcallBack[e]()}};this.buttonsDiv.innerHTML="";for(var o=0;o<this.buttonsArray.length;o++){var p,u=this.buttonsArray[o];u.parentElement=this.buttonsDiv,this.thatcallBack.push(u.callBack),u.callBack=d(o),p=new gm.widgets.Button(u),p.render()}"function"==typeof n&&n.apply(null)}},this.destroy=function(){this.hide();var e=document.getElementById(this.styleNodeId);e&&e.parentNode.removeChild(e);var n=document.getElementById(this.wrapperDivId);n&&n.parentNode.removeChild(n),gm.widgets.PopUp.prototype.destroy.apply(t)},this},gm.widgets.PopUp.prototype=Object.create(gm.widgets.Base.prototype),gm.widgets.PopUp.prototype.constructor=gm.widgets.PopUp,gm.widgets.PopUp.prototype.show=function(){if(this.hasRendered()){var e=document.getElementById(this.wrapperDivId);e.classList.remove("hidden"),this.element.style.top=this.top;var t=this.element.className;this.element.className=gm.widgets.util.modClassName(t,"hidden","remove"),gm.system.isRotary&&this.watchRotaryHandle===-1&&(this.allRotaryElements_DefaultRotary=gm.system.allRotaryElements,this.currentRotaryElementIndex_DefaultRotary=gm.system.currentRotaryElementIndex,this.activeRotaryElement_DefaultRotary=gm.system.activeRotaryElement,gm.system.indexElementsForDefaultRotary(this.id),this.watchRotaryHandle=gm.info.watchRotaryControl(gm.system._handleWatchForRotary,function(){console.log("gm.widgets.PopUp: Watch Rotary Failed")}))}},gm.widgets.PopUp.prototype.hide=function(){if(this.hasRendered()){var e=document.getElementById(this.wrapperDivId);e.classList.add("hidden");var t=this.element.className;this.element.className=gm.widgets.util.modClassName(t,"hidden","add"),this.watchRotaryHandle!==-1&&(gm.info.clearRotaryControl(this.watchRotaryHandle),this.watchRotaryHandle=-1,gm.system.indexElementsForDefaultRotary())}},window.gm=window.gm||{},gm.widgets=gm.widgets||{},gm.vehicle.getVehicleConfiguration(function(e){var t;t=isDefined(e)&&isDefined(e.region)?e.region.toLowerCase():"usa";var n=doesSupportNewKeyboard()&&isNewKeyboardMarket(t);gm.widgets.keypad=n?boschKeyboard():app0Keyboard()},function(e){console.log("Error:"+e)});var keyboardAutoHideOnDrive=function(){function e(){gm.system.clearSpeed(r)}function t(){gm.widgets.keypad.hideKeypad()}function n(n){n>1&&(e(),t())}function a(){console.log("WatchSpeed error for keyboardAutoHideOnDrive!!")}function i(){return e(),gm.system.getSpeed()>1?t():(isDefined(l)||(l=gm.widgets.keypad.hideKeypad,gm.widgets.keypad.hideKeypad=function(){e(),l()}),void(r=gm.system.watchSpeed(n,a)))}function s(){e(),isDefined(l)&&(gm.widgets.keypad.hideKeypad=l,l=void 0)}var l,r;return{startKeyboardDriverGuard:i,stopKeyboardDriverGuard:s}}();